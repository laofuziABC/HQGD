<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>设备管理</title>
	</head>
	<body class="page-content">
		<div class="container-fluid">
			<!-- 页面标题和导航【开始】-->
			<div class="row-fluid">
				<div class="span12">
					<h3 class="page-title">关联设备列表&nbsp;<small>此功能用于管理当前所有关联设备</small></h3>
					<!--导航-->
					<ul class="breadcrumb">
						<li>
							<i class="icon-home"></i>
							<a href="#">首页</a> 
							<span class="icon-angle-right"></span>
						</li>
						<li>
							<a href="#">设备管理</a>
							<span class="icon-angle-right"></span>
						</li>
						<li><a href="#">关联设备列表</a></li>
					</ul>
				</div>
			</div>
			<!-- 页面标题和导航【结束】-->
			<!--加载关联设备列表【开始】-->
			<div class="row-fluid">
				<div class="span12">
					<div class="portlet box blue">
						<!--关联设备列表【开始】-->
						<div class="portlet-body">
								<div class="clearfix">
									<!--新增按钮-->
									<div class="btn-group">
										<button id="sample_editable_1_new" class="btn green" onclick="getEquiEdit();">
											新增设备&nbsp;<i class="icon-plus"></i>
										</button>
									</div>
									<!--便捷操作工具栏-->
									<div class="btn-group pull-right">
										<button class="btn dropdown-toggle" data-toggle="dropdown">更多操作<i class="icon-angle-down"></i>
										</button>
										<ul class="dropdown-menu pull-right">
											<li><a href="#">打印</a></li>
											<li><a href="#">保存为PDF</a></li>
											<li><a href="#">导出到Excel</a></li>
										</ul>
									</div>
								</div>
								<!--表格【开始】-->
								<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
									<thead>
										<tr> 
											<th>设备编号</th>
											<th>设备名称</th>
											<th>设备型号</th>
											<!-- <th>当前使用通道数量</th> -->
											<th>所属用户</th>
											<th>运行状态</th>
											<th>其它操作</th>
										</tr>
									</thead>

									<tbody id="equipmentList">
										<tr class="">
											<td>1</td>
											<td>测温仪</td>
											<td>XXX-XXX</td>
											<td>6</td>
											<td>XXX公司</td>
											<td>正常</td>
											<td class="center">
												<a class="details" href="#">详情</a>&nbsp;
												<a class="edit" href="#">编辑</a>&nbsp;
												<a class="delete" href="#">删除</a>&nbsp;
											</td>
										</tr>
									</tbody>
								</table>
								<!--用户列表【结束】-->
							</div>
					</div>
				</div>
			</div>
			<!--加载关联设备列表【结束】-->
		</div>
		
		<script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="media/js/jquery.dataTables.js"></script>
		<script type="text/javascript" src="media/js/DT_bootstrap.js"></script>
		
		<script src="media/js/table-editable.js"></script>
		<script>
			jQuery(document).ready(function() {
			   getEquipmentList();
			  /*  TableEditable.init(); */
			});
			//获取所有设备信息列表
			function getEquipmentList(){
				$.ajax({
					url: "equipment/selectAll",
					type: "post",
					dataType: "json",
					success: function(result){
						var data = result.data;
						var equipList = "";
						for(let i=0; i<data.length; i++){
							equipList+="<tr>";
							equipList+="<td>"+(i+1)+"</td>";
							equipList+="<td>"+data[i].equipmentName+"</td>";
							equipList+="<td>XXX-XXX</td>";
							/* equipList+="<td>"+data[i].equipmentName+"</td>"; */
							equipList+="<td>"+data[i].userName+"</td>";
							equipList+="<td>正常</td>";
							equipList+="<td class=\"center\">";
							equipList+="<a class=\"details\" href=\"#\" onclick=\"getEquiDetails('"+data[i].equipmentId+"');\">详情</a>&nbsp;";
							equipList+="<a class=\"edit\" href=\"#\" onclick=\"getEquiEdit('"+data[i].equipmentId+"');\">编辑</a>&nbsp;";
							equipList+="<a class=\"delete\" href=\"#\"onclick=\"getEquiDelete('"+data[i].equipmentId+"');\">删除</a>&nbsp;";
							equipList+="</td>";
							equipList+="</tr>";
						}
						$("#equipmentList").html(equipList);
					}
				});
			}
			//查看设备详情
			function getEquiDetails(param){
				let title="设备详情";
				let url = "formHtml/equipment/equi-details.html";
				var params={"width": 700, "height": 800, "equipmentId": param};
				parent.openModal(title, url, params);
			}
			//编辑或者新增设备信息
			function getEquiEdit(param){
				let title;
				if(param == null){title = "新增设备"; }
				else{title = "编辑设备"; }
				let url = "formHtml/equipment/equi-edit.html";
				var params={"width": 700, "height": 800, "equipmentId": param};
				parent.openModal(title, url, params);
			}
			//删除一条设备信息
			function getEquiDelete(param){
				$.ajax({
					url: "equipment/delete",
					type: "post",
					data: {"equipmentId": param.trim()},
					dataType: "json",
					success: function(result){
						if(result.success){ alert("设备删除成功！"); }
						else{ alert("设备删除失败！"); }
						getEquipmentList();
					}
				});
			}
		</script>
	</body>
</html>
