<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>用户管理</title>
	</head>
	<body class="page-content">
		<div class="container-fluid">
			<!-- 页面标题和导航【开始】-->
			<div class="row-fluid">
				<div class="span12">
					<h3 class="page-title">用户列表&nbsp;<small>此功能用于管理所有用户</small></h3>
					<!--导航-->
					<ul class="breadcrumb">
						<li>
							<i class="icon-home"></i>
							<a href="#">首页</a> 
							<span class="icon-angle-right"></span>
						</li>
						<li>
							<a href="#">用户管理</a>
							<span class="icon-angle-right"></span>
						</li>
						<li><a href="#">用户列表</a></li>
					</ul>
				</div>
			</div>
			<!-- 页面标题和横向导航【结束】-->
			<!--加载用户列表【开始】-->
			<div class="row-fluid">
				<div class="span12">
					<div class="portlet box blue">
						<!--用户列表【开始】-->
						<div class="portlet-body">
							<div class="clearfix">
								<!--新增按钮-->
								<div class="btn-group">
									<button id="sample_editable_1_new" class="btn green" onclick="getUserEdit();">
										新增用户&nbsp;<i class="icon-plus"></i>
									</button>
								</div>
								<!--便捷操作工具栏-->
								<div class="btn-group pull-right">
									<button class="btn dropdown-toggle" data-toggle="dropdown">更多操作<i class="icon-angle-down"></i>
									</button>
									<ul class="dropdown-menu pull-right">
										<li><a href="#">打印</a></li>
										<li><a href="#">保存为PDF</a></li>
										<li><a href="#">导出到Excel</a></li>
									</ul>
								</div>
							</div>
							<!--表格【开始】-->
							<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
								<thead>
									<tr> 
										<th></th>
										<th>登录名</th>
										<th>用户状态</th>
										<th>备注</th>
										<th>其它操作</th>
									</tr>
								</thead>

								<tbody id="userList">
									<tr class="">
										<td>1</td>
										<td>abc</td>
										<td>XXX公司</td>
										<td>启用</td>
										<td class="center">
											<a class="details" href="javascript:;" onclick="getUserDetails();">详情</a>&nbsp;
											<a class="edit" href="javascript:;" onclick="getUserEdit(1);">编辑</a>&nbsp;
											<a class="delete" href="javascript:;"onclick="getUserDelete();">删除</a>&nbsp;
											<a class="resetpsw" href="javascript:;" onclick="resetUserPsw();">密码初始化</a>
										</td>
									</tr>
								</tbody>
							</table>
							<!--用户列表【结束】-->
						</div>
					</div>
				</div>
			</div>
			<!--加载用户列表【结束】-->
		</div>
		<script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="media/js/jquery.dataTables.js"></script>
		<script type="text/javascript" src="media/js/DT_bootstrap.js"></script>
		
		<script src="media/js/table-editable.js"></script>    
		<script>
			jQuery(document).ready(function() {
				getUserList();
				/* TableEditable.init(); */
			});
			
			//获取用户列表
			function getUserList(){
				$.ajax({
					url: "user/selectAll",
					type: "post",
					dataType: "json",
					success: function(result){
						var userlist = "";
						for(let i=0; i<result.length; i++){
							userlist += "<tr class=\"\">";
							userlist += "<td>"+(i+1)+"</td>";
							userlist += "<td>"+result[i].userName+"</td>";
							if(result[i].isdel == "N"){userlist += "<td>启用</td>"; }
							else{userlist += "<td>已删除</td>";}
							userlist += "<td>"+result[i].comments+"</td>";
							userlist += "<td class=\"center\">";
							userlist += "<a class=\"details\" href=\"#\" onclick=\"getUserDetails('"+result[i].id+"');\">详情</a>&nbsp;";
							userlist += "<a class=\"edit\" href=\"#\" onclick=\"getUserEdit('"+result[i].id+"');\">编辑</a>&nbsp;";
							userlist += "<a class=\"delete\" href=\"#\" onclick=\"getUserDelete('"+result[i].id+"');\">删除</a>&nbsp;";
							userlist += "<a class=\"resetpsw\" href=\"#\" onclick=\"initUserPassword('"+result[i].id+"');\">密码初始化</a>";
							userlist += "</td>";
							userlist += "</tr>";
						}
						$("#userList").html(userlist);
					}
				});
			}
			//查看用户详情
			function getUserDetails(param){
				let title = "用户详情";
				let url = "formHtml/user/user-details.html";
				var params = {"width": 600, "height": 500, "userId": param.trim()};
				parent.openModal(title, url, params);
			}
			//添加或者编辑用户
			function getUserEdit(param){
				let title;
				if(param == null){ title = "新增用户"; }
				else{ title = "编辑用户"; }
				let url = "formHtml/user/user-edit.html";
				var params = {"width": 600, "height": 400, "userId": param};
				parent.openModal(title, url, params);
			}
			//删除用户
			function getUserDelete(param){
				$.ajax({
					url: "user/delete",
					type: "post",
					data: {"userId": param},
					dataType: "json",
					success: function(result){
						if(result.success){ alert("删除成功！"); }
						else{ alert("删除失败！"); }
						getUserList();
					}
				});
			}
			//用户密码初始化
			function initUserPassword(param){
				alert("用户密码初始化"+param);
			}
		</script>
		<!-- <script type="text/javascript">
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-37564768-1']);
			_gaq.push(['_setDomainName', 'keenthemes.com']);
			_gaq.push(['_setAllowLinker', true]);
			_gaq.push(['_trackPageview']);
			(function() {
				var ga = document.createElement('script');
				ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		</script> -->
	</body>
</html>
