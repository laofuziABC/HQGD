<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>和其光电</title>
<!-- Tell the browser to be responsive to screen width -->
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<!-- Bootstrap 3.3.7 -->
<link rel="stylesheet"
	href="bower_components/bootstrap/dist/css/bootstrap.min.css">
<!-- Font Awesome -->
<link rel="stylesheet"
	href="bower_components/font-awesome/css/font-awesome.min.css">
<!-- Ionicons -->
<link rel="stylesheet"
	href="bower_components/Ionicons/css/ionicons.min.css">
<!-- jvectormap -->
<link rel="stylesheet"
	href="bower_components/jvectormap/jquery-jvectormap.css">
<!-- Theme style -->
<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
<!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
<link rel="stylesheet" href="dist/css/skins/_all-skins.min.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

<!-- Google Font -->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>
<body class="hold-transition skin-blue sidebar-mini">

	<div class="wrapper">

		<!-- 页面顶部标题【开始】 -->
		<header class="main-header" id="main-header"> </header>
		<!-- 页面顶部标题【结束】 -->
		<!-- 侧边栏【开始】 -->
		<aside class="main-sidebar" id="main-sidebar"></aside>
		<!-- 侧边栏【结束】 -->
		<div id="content-wrapper">
			<!-- Main content -->
			<section class="content" style="background: #ecf0f5;">
				<div id="mapContainer" class="map" tabindex="0"></div>
			</section>
		</div>
		<!-- /.content-wrapper -->

		<footer class="main-footer">
			<strong>Copyright &copy; 2018-2028 <a
				href="https://adminlte.io">Almsaeed Studio</a>.
			</strong> All rights reserved.
		</footer>

		<!-- Control Sidebar -->
		<aside class="control-sidebar control-sidebar-dark">
			<!-- Create the tabs -->
			<ul class="nav nav-tabs nav-justified control-sidebar-tabs">
				<li><a href="#control-sidebar-home-tab" data-toggle="tab"><i
						class="fa fa-home"></i></a></li>
				<li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i
						class="fa fa-gears"></i></a></li>
			</ul>
			<!-- Tab panes -->
			<div class="tab-content"></div>
		</aside>
		<!-- /.control-sidebar -->
		<!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
		<div class="control-sidebar-bg"></div>

	</div>
	<!-- ./wrapper -->

	<!-- jQuery 3 -->
	<!-- <script src="bower_components/jquery/dist/jquery.min.js"></script> -->
	<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
	<!-- Bootstrap 3.3.7 -->
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- FastClick -->
	<script src="bower_components/fastclick/lib/fastclick.js"></script>
	<!-- AdminLTE App -->
	<script src="dist/js/adminlte.min.js"></script>
	<!-- Sparkline -->
	<script
		src="bower_components/jquery-sparkline/dist/jquery.sparkline.min.js"></script>
	<!-- jvectormap  -->
	<script src="plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
	<script src="plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
	<!-- SlimScroll -->
	<script
		src="bower_components/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<!-- ChartJS -->
	<script src="bower_components/chart.js/Chart.js"></script>
	<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
	<!-- <script src="dist/js/pages/dashboard2.js"></script> -->
	<!-- AdminLTE for demo purposes -->
	<script src="dist/js/demo.js"></script>
	<script src="vince/js/nicescroll.js"></script>
	<script src="vince/js/demo.js"></script>
	<script src="vince/drag/zxx.drag.1.0.js"></script>
	<script type="text/javascript">
		//获取页面参数【开始】
		function getParam(string) {
		    var reg = new RegExp("(^|&)" + string + "=([^&]*)(&|$)", "i");  
		    var l = decodeURI(window.location.search);
		    var r = l.substr(1).match(reg);
		    if (r != null){
		    	var result = decodeURI(r[2]);
		    	return unescape(result);
		    }
		}
		//获取页面参数【结束】
		//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【开始】
		function formatDateToString(param){
			var y = param.getFullYear();
			var M = unifiedFormat(param.getMonth()+1);
			var d = unifiedFormat(param.getDate());
			var H = unifiedFormat(param.getHours());
			var m = unifiedFormat(param.getMinutes());
			var s = unifiedFormat(param.getSeconds());
			var result = y+"-"+M+"-"+d+" "+H+":"+m+":"+s;
			return result;
		}
		function formatInitDateToString(param){
			var y = param.getFullYear();
			var M = unifiedFormat(param.getMonth()+1);
			var d = unifiedFormat(param.getDate());
			var result = y+"-"+M+"-"+d+" 00:00:00";
			return result;
		}
		function unifiedFormat(param){
			return (param<10)?("0"+param):param;
		}
		//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【结束】
	</script>
	<!-- 页面地图【开始】 -->
	<script type="text/javascript"
		src="https://webapi.amap.com/maps?v=1.4.11&key=f6ee07ce6b36ef10876b7d1ed533dadc&plugin=AMap.MarkerClusterer">
		</script>
	<script type="text/javascript">
			//设定高度适应屏幕高度【开始】
			var myWindow=document.getElementById("mapContainer");
			var screenHeight = window.screen.availHeight;
			var screenWidth = window.screen.availWidth;
			myWindow.style.width=screenWidth+"px";
			myWindow.style.height=screenHeight+"px";
			//设定高度适应屏幕高度【结束】
			var roleId =getParam("roleId");
			var userName =getParam("userName");
			$("#main-sidebar").load("childrenHtml/side-menu.html");
			$("#main-header").load("childrenHtml/title.html");
			$(function(){
				if(roleId=="0"){
					$("#main-sidebar").load("childrenHtml/side-menu1.html");
				}else{$("#main-sidebar").load("childrenHtml/side-menu.html");}
				
				$("#main-header").load("childrenHtml/title.html");
			});
			var cluster, markers = [];
		    var points= [];
		    var map = new AMap.Map("mapContainer", {
		    	mapStyle: 'amap://styles/normal',
		        resizeEnable: true,
		        center: [105, 32],
		        zoom: 5
		    });
		    getLngLat();
		    
		    function getLngLat(){
		    	$.ajax({
					url:"map/getPositions",
					type:"post",
					async:false,
					dataType: "json",
					success: function(result){
						points = result.data;
					}
				});
		    }
		    	
		    for (var i = 0; i < points.length; i += 1) {
		        markers.push(new AMap.Marker({
		            position: points[i].split(','),
		            content: '<div style="background-color: hsla(180, 100%, 50%, 0.7); height: 24px; width: 24px; border: 1px solid hsl(180, 100%, 40%); border-radius: 12px; box-shadow: hsl(180, 100%, 50%) 0px 0px 1px;"></div>',
		            offset: new AMap.Pixel(-15, -15)
		        }))
		    }
	
		    var count = markers.length;
		    var _renderCluserMarker = function (context) {
		        var factor = Math.pow(context.count / count, 1 / 18);
		        var div = document.createElement('div');
		        var Hue = 180 - factor * 180;
		        var bgColor = 'hsla(' + Hue + ',100%,50%,0.7)';
		        var fontColor = 'hsla(' + Hue + ',100%,20%,1)';
		        var borderColor = 'hsla(' + Hue + ',100%,40%,1)';
		        var shadowColor = 'hsla(' + Hue + ',100%,50%,1)';
		        div.style.backgroundColor = bgColor;
		        var size = Math.round(30 + Math.pow(context.count / count, 1 / 5) * 20);
		        div.style.width = div.style.height = size/2 + 'px';
		        div.style.border = 'solid 1px ' + borderColor;
		        div.style.borderRadius = size / 2 + 'px';
		        div.style.boxShadow = '0 0 1px ' + shadowColor;
		        div.innerHTML = context.count;
		        div.style.lineHeight = size/2 + 'px';
		        div.style.color = fontColor;
		        div.style.fontSize = '14px';
		        div.style.textAlign = 'center';
		        context.marker.setOffset(new AMap.Pixel(-size / 2, -size / 2));
		        context.marker.setContent(div)
		    };
		    addCluster(2);
	
		    function addCluster(tag) {
		        if (cluster) {
		            cluster.setMap(null);
		        }
		        if (tag == 2) {//完全自定义
		            cluster = new AMap.MarkerClusterer(map, markers, {
		                gridSize: 80,
		                renderCluserMarker: _renderCluserMarker
		            });
		        }else if (tag == 1) {//自定义图标
	            var sts = [{
	                url: "https://a.amap.com/jsapi_demos/static/images/blue.png",
	                size: new AMap.Size(32, 32),
	                offset: new AMap.Pixel(-16, -16)
	            }, {
	                url: "https://a.amap.com/jsapi_demos/static/images/green.png",
	                size: new AMap.Size(32, 32),
	                offset: new AMap.Pixel(-16, -16)
	            }, {
	                url: "https://a.amap.com/jsapi_demos/static/images/orange.png",
	                size: new AMap.Size(36, 36),
	                offset: new AMap.Pixel(-18, -18)
	            }, {
	                url: "https://a.amap.com/jsapi_demos/static/images/red.png",
	                size: new AMap.Size(48, 48),
	                offset: new AMap.Pixel(-24, -24)
	            }, {
	                url: "https://a.amap.com/jsapi_demos/static/images/darkRed.png",
	                size: new AMap.Size(48, 48),
	                offset: new AMap.Pixel(-24, -24)
	            }];
	            cluster = new AMap.MarkerClusterer(map, markers, {
	                styles: sts,
	                gridSize: 80
	            });
	        } else {//默认样式
	            cluster = new AMap.MarkerClusterer(map, markers, {gridSize: 80});
	        }
	    }
	</script>
	<!-- 页面地图【结束】 -->


</body>
</html>
