<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=10">
<title>首页</title>
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
<link rel="stylesheet" href="bootstrap/css/bootstrap.css">
<link rel="stylesheet" href="dist/css/ionicons.min.css">
<link rel="stylesheet" href="dist/css/AdminLTE.css">
<link rel="stylesheet" href="dist/css/skins/_all-skins.css">
<link rel="stylesheet" href="vince/css/vince.css">
<link rel="stylesheet" href="vince/biao/css/font-awesome.min.css">
<!--[if lt IE 9]>
	  <script src="dist/js/html5shiv.min.js"></script>
	  <script src="dist/js/respond.min.js"></script>
	  <![endif]-->
</head>
<body class="hold-transition skin-blue sidebar-mini">

	<div class="wrapper">
		<!-- 页面顶部标题【开始】 -->
		<header class="main-header" id="main-header"> </header>
		<!-- 页面顶部标题【结束】 -->
		<!-- 侧边栏【开始】 -->
		<aside class="main-sidebar" id="main-sidebar"></aside>
		<!-- 侧边栏【结束】 -->
		<!-- 页面内容【开始】 -->
		<div class="content-wrapper" id="content-wrapper">
			<!-- 面包屑【开始】 -->
			<!-- <section class="content-header"> 
					<ol class="breadcrumb">
						<li><a href="#"><i class="fa fa-dashboard"></i> 首页</a></li>
					</ol>
				</section> -->
			<!-- 面包屑【结束】 -->
			<!-- 主体内容【开始】 -->
			<div class="content qqq"
				style="z-index: 5; width: 100%; height: 95%;">
				<!-- 加载地图 -->
				<div id="mapContainer" class="map" tabindex="0"></div>
			</div>
			<!-- 主体内容【结束】 -->
		</div>
		<!-- 页面内容【结束】 -->
		<footer class="main-footer">
			<div class="pull-right hidden-xs">
				<b></b>
			</div>
			<strong>Copyright &copy; 2014-2016</strong>
		</footer>
		<div class="control-sidebar-bg"></div>
	</div>

	<!-- 引入JS文档【开始】 -->
	<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
	<script src="bootstrap/js/bootstrap.min.js"></script>
	<script src="dist/js/app.min.js"></script>

	<script src="vince/js/nicescroll.js"></script>
	<script src="dist/js/demo.js"></script>
	<script src="vince/js/demo.js"></script>

	<script src="vince/drag/zxx.drag.1.0.js"></script>
	<!-- 引入JS文档【结束】 -->

	<script type="text/javascript">
			//获取页面参数【开始】
			function getParam(string) {
			    var reg = new RegExp("(^|&)" + string + "=([^&]*)(&|$)", "i");  
			    var l = decodeURI(window.location.search);
			    var r = l.substr(1).match(reg);
			    if (r != null){
			    	var result = decodeURI(r[2]);
			    	return unescape(result);
			    }
			}
			//获取页面参数【结束】
			//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【开始】
			function formatDateToString(param){
				var y = param.getFullYear();
				var M = unifiedFormat(param.getMonth()+1);
				var d = unifiedFormat(param.getDate());
				var H = unifiedFormat(param.getHours());
				var m = unifiedFormat(param.getMinutes());
				var s = unifiedFormat(param.getSeconds());
				var result = y+"-"+M+"-"+d+" "+H+":"+m+":"+s;
				return result;
			}
			function formatInitDateToString(param){
				var y = param.getFullYear();
				var M = unifiedFormat(param.getMonth()+1);
				var d = unifiedFormat(param.getDate());
				var result = y+"-"+M+"-"+d+" 00:00:00";
				return result;
			}
			function unifiedFormat(param){
				return (param<10)?("0"+param):param;
			}
			//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【结束】
		</script>
	<!-- 页面地图【开始】 -->
	<script type="text/javascript"
		src="https://webapi.amap.com/maps?v=1.4.11&key=f6ee07ce6b36ef10876b7d1ed533dadc&plugin=AMap.MarkerClusterer">
		</script>
	<script type="text/javascript">
			//设定高度适应屏幕高度【开始】
			var myWindow=document.getElementById("mapContainer");
			var screenHeight = window.screen.availHeight;
			var screenWidth = window.screen.availWidth;
			myWindow.style.width=screenWidth+"px";
			myWindow.style.height=screenHeight+"px";
			//设定高度适应屏幕高度【结束】
			var roleId =getParam("roleId");
			var userName =getParam("userName");
			debugger;
			$(function(){
				if(roleId=="0"){
					$("#main-sidebar").load("childrenHtml/side-menu1.html");
				}else{$("#main-sidebar").load("childrenHtml/side-menu.html");}
				
				$("#main-header").load("childrenHtml/title.html");
			});
			var cluster, markers = [];
		    var points= [];
		    var map = new AMap.Map("mapContainer", {
		    	mapStyle: 'amap://styles/normal',
		        resizeEnable: true,
		        center: [105, 32],
		        zoom: 5
		    });
		    getLngLat();
		    
		    function getLngLat(){
		    	$.ajax({
					url:"map/getPositions",
					type:"post",
					async:false,
					dataType: "json",
					success: function(result){
						points = result.data;
					}
				});
		    }
		    	
		    for (var i = 0; i < points.length; i += 1) {
		        markers.push(new AMap.Marker({
		            position: points[i].split(','),
		            content: '<div style="background-color: hsla(180, 100%, 50%, 0.7); height: 24px; width: 24px; border: 1px solid hsl(180, 100%, 40%); border-radius: 12px; box-shadow: hsl(180, 100%, 50%) 0px 0px 1px;"></div>',
		            offset: new AMap.Pixel(-15, -15)
		        }))
		    }
	
		    var count = markers.length;
		    var _renderCluserMarker = function (context) {
		        var factor = Math.pow(context.count / count, 1 / 18);
		        var div = document.createElement('div');
		        var Hue = 180 - factor * 180;
		        var bgColor = 'hsla(' + Hue + ',100%,50%,0.7)';
		        var fontColor = 'hsla(' + Hue + ',100%,20%,1)';
		        var borderColor = 'hsla(' + Hue + ',100%,40%,1)';
		        var shadowColor = 'hsla(' + Hue + ',100%,50%,1)';
		        div.style.backgroundColor = bgColor;
		        var size = Math.round(30 + Math.pow(context.count / count, 1 / 5) * 20);
		        div.style.width = div.style.height = size/2 + 'px';
		        div.style.border = 'solid 1px ' + borderColor;
		        div.style.borderRadius = size / 2 + 'px';
		        div.style.boxShadow = '0 0 1px ' + shadowColor;
		        div.innerHTML = context.count;
		        div.style.lineHeight = size/2 + 'px';
		        div.style.color = fontColor;
		        div.style.fontSize = '14px';
		        div.style.textAlign = 'center';
		        context.marker.setOffset(new AMap.Pixel(-size / 2, -size / 2));
		        context.marker.setContent(div)
		    };
		    addCluster(2);
	
		    function addCluster(tag) {
		        if (cluster) {
		            cluster.setMap(null);
		        }
		        if (tag == 2) {//完全自定义
		            cluster = new AMap.MarkerClusterer(map, markers, {
		                gridSize: 80,
		                renderCluserMarker: _renderCluserMarker
		            });
		        } else if (tag == 1) {//自定义图标
		            var sts = [{
		                url: "https://a.amap.com/jsapi_demos/static/images/blue.png",
		                size: new AMap.Size(32, 32),
		                offset: new AMap.Pixel(-16, -16)
		            }, {
		                url: "https://a.amap.com/jsapi_demos/static/images/green.png",
		                size: new AMap.Size(32, 32),
		                offset: new AMap.Pixel(-16, -16)
		            }, {
		                url: "https://a.amap.com/jsapi_demos/static/images/orange.png",
		                size: new AMap.Size(36, 36),
		                offset: new AMap.Pixel(-18, -18)
		            }, {
		                url: "https://a.amap.com/jsapi_demos/static/images/red.png",
		                size: new AMap.Size(48, 48),
		                offset: new AMap.Pixel(-24, -24)
		            }, {
		                url: "https://a.amap.com/jsapi_demos/static/images/darkRed.png",
		                size: new AMap.Size(48, 48),
		                offset: new AMap.Pixel(-24, -24)
		            }];
		            cluster = new AMap.MarkerClusterer(map, markers, {
		                styles: sts,
		                gridSize: 80
		            });
		        } else {//默认样式
		            cluster = new AMap.MarkerClusterer(map, markers, {gridSize: 80});
		        }
		    }
		</script>
	<!-- 页面地图【结束】 -->
</body>
</html>