<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>欢迎登录！</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	<!--BootStrap样式-->
	<link type="text/css" href="media/css/bootstrap.min.css" rel="stylesheet" />
	<!--字体样式-->
	<link type="text/css" href="media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
	<!--表单元素样式-->
	<link type="text/css" href="media/css/style-metro.css" rel="stylesheet" type="text/css"/>
	<!--表单、页面、图标样式-->
	<link type="text/css" href="media/css/style.css" rel="stylesheet" type="text/css"/>
	<!--页面布局样式-->
	<link type="text/css" href="media/css/style-responsive.css" rel="stylesheet" type="text/css"/>
	<!--页面风格样式-->
	<link type="text/css" href="media/css/light.css" rel="stylesheet" type="text/css" id="style_color"/>
	<style type="text/css">
		#portlet-config{width: 400px; height: 400px; margin: auto;}
		#alertInfo, #confirmInfo{width: 400px; height: 220px; margin: -300% 300%; background: rgba(224, 255, 255, 1);}
		#alertInfo .info-top-bar, #confirmInfo .info-top-bar{background-color: #28B779; height: 20px; border-radius: 5px 5px 0px 0px;}
		#alertInfo .info-content, #confirmInfo .info-content{border: 1px solid #28B779;}
		#alert-info-body{text-align: center;font-size: 20px;padding: 10% 0px;}
		#alertInfo input{width: 30%; height: 35px; color: #FFFFFF; background-color: #28B779; margin: 3% 35%; font-size: 18px;
									border: 0px; border-radius: 4px;}
		#confirm-info-body{text-align: center;font-size: 20px;padding: 10% 0px;}
		#confirmInfo .buttons{margin: 3% 10%;}
		#confirmInfo .buttons input{width: 35%; height: 35px; color: #FFFFFF; background-color: #28B779; font-size: 18px;
									border: 0px; border-radius: 4px; margin: 0 6%;}
	</style>
</head>
<body class="page-header-fixed">
	<!-- 设置侧边栏【开始】 -->
	<div class="page-sidebar nav-collapse collapse">
		<ul class="page-sidebar-menu" id="page-sidebar-menu">
			<li><div class="sidebar-toggler hidden-phone"></div></li>
			<!--设备监控-->
			<li class="">
				<a href="#">
					<i class="icon-th"></i> 
					<span class="title">监测数据</span>
					<span class="arrow "></span>
				</a>
				<!--二级菜单-->
				<ul class="sub-menu" id="equipments">
					<li ><a href="#" onclick="loadContext();">设备一</a></li>
					<li ><a href="#" onclick="openConfirmInfo('12345');">设备二</a></li>
					<li ><a href="#" onclick="openAlertInfo(123);">设备三</a></li>
					<li ><a href="#" onclick="openModal(null,null,null);">……</a></li>
				</ul>
			</li>
		</ul>
	</div>
	<!-- 设置侧边栏【结束】 -->
	<!-- 页面内容【开始】 -->
	<div class="page-content" id="page-content" style="z-index: 5;"></div>
	<!-- 页面内容【结束】 -->
	<!-- 页脚区域【开始】 -->
	<div class="footer">
		<div class="footer-inner" style="margin: auto 40%;width: 20%;">
			2018.11.06 &copy; Metronic by laofuzi.
		</div>
		<div class="footer-tools">
			<span class="go-top">
				<i class="icon-angle-up"></i>
			</span>
		</div>
	</div>
	<!-- 页脚区域【结束】 -->
	<!--模态框以及弹框【开始】-->
	<div class="page-sidebar nav-collapse collapse" style="none;">
		<!-- 页面隐藏模态框【开始】-->
		<div id="portlet-config" class="modal hide" style="display: none;">
			<div class="modal-header">
				<button data-dismiss="modal" class="close" type="button" onclick="closeModal();"></button>
				<h3 id="modal-title">模态框标题</h3>
			</div>
			<div id="modal-body" class="modal-body">模态框内容</div>
		</div>
		<!-- 页面隐藏模态框【结束】-->
		<!--页面弹框【开始】-->
		<div id="alertInfo" lass="modal hide" style="display: none;">
			<div class="modal-header info-top-bar"></div>
			<div class="info-content">
				<div id="alert-info-body" class="modal-body">弹框内容</div>
				<input type="button" value="关闭" onclick="closeAlert();"/>
			</div>
		</div>
		<!--页面弹框【结束】-->
		<!--页面提示框【开始】-->
		<div id="confirmInfo" lass="modal hide" style="display: none;">
			<div class="modal-header info-top-bar"></div>
			<div class="info-content">
				<div id="confirm-info-body" class="modal-body">弹框内容</div>
				<div class="buttons">
					<!-- <input type="button" value="确定" onclick="confirmResult(true);"/>
					<input type="button" value="取消" onclick="confirmResult(false);"/> -->
					<input type="button" value="确定" name="true" onclick="javascript: confirmResult();"/>
					<input type="button" value="取消" name="false" onclick="javascript: confirmResult();"/>
				</div>
			</div>
		</div>
		<!--页面提示框【结束】-->
	</div>
	<!--模态框以及弹框【结束】-->
	
	<script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
	<script src="media/js/app.js" type="text/javascript"></script>
	<script>
		jQuery(document).ready(function() {
		   App.init();
		});
		
		//获取页面参数
		function getParam(string) {
		    var reg = new RegExp("(^|&)" + string + "=([^&]*)(&|$)", "i");  
		    var l = decodeURI(window.location.search);
		    var r = l.substr(1).match(reg);
		    if (r != null){
		    	var result = decodeURI(r[2]);
		    	return unescape(result);
		    }
		}
		//根据roleId加载侧边菜单栏——roleId=1，管理员；其余都为普通用户
		var roleId =getParam("roleId");
		var menuHtml="";
		menuHtml+="<li><div class=\"sidebar-toggler hidden-phone\"></div></li>";
		if(roleId == 1){
			menuHtml+="<li class=\"start active\">";
			menuHtml+="<a href=\"index.html?roleId=1\">";
			menuHtml+="<i class=\"icon-home\"></i> ";
			menuHtml+="<span class=\"title\">首页</span>";
			menuHtml+="<span class=\"selected\"></span>";
			menuHtml+="</a></li>";
			menuHtml+="<li class=\"\" onclick=\"loadContext(101);\">";
			menuHtml+="<a href=\"#\">";
			menuHtml+="<i class=\"icon-user\"></i> ";
			menuHtml+="<span class=\"title\">用户管理</span>";
			menuHtml+="<span class=\"arrow\"></span>";
			menuHtml+="</a></li>";
			menuHtml+="<li class=\"\" onclick=\"loadContext(201);\">";
			menuHtml+="<a href=\"#\">";
			menuHtml+="<i class=\"icon-cogs\"></i> ";
			menuHtml+="<span class=\"title\">设备管理</span>";
			menuHtml+="<span class=\"arrow\"></span>";
			menuHtml+="</a></li>";
			menuHtml+="<li class=\"\" onclick=\"loadContext(301);\">";
			menuHtml+="<a href=\"#\">";
			menuHtml+="<i class=\"icon-th\"></i> ";
			menuHtml+="<span class=\"title\">监测数据</span>";
			menuHtml+="<span class=\"arrow\"></span>";
			menuHtml+="</a></li>";
		}else{
			menuHtml+="<li class=\"active\">";
			menuHtml+="<a href=\"#\">";
			menuHtml+="<i class=\"icon-th\"></i> ";
			menuHtml+="<span class=\"title\">监测数据</span>";
			menuHtml+="<span class=\"arrow\"></span>";
			menuHtml+="</a>";
			menuHtml+="<ul class=\"sub-menu\" id=\"equipments\"></ul>";
			menuHtml+="</li>";
		}
		$("#page-sidebar-menu").html(menuHtml);
		/* 获取侧边栏普通用户设备列表【开始】 */
		$.ajax({
			url:"equipment/selectAll",
			type: "post",
			data:{"param":null},
			dataType: "json",
			success: function(result){
				let data = result.data;
				var equiMenu = "";
				for(let i=0; i<data.length; i++){
					equiMenu+="<li><a href=\"#\" onclick=\"loadContext(' "+data[i].equipmentId+" ');\">"+data[i].equipmentName+"</a></li>"
				}
				$("#equipments").empty();
				$("#equipments").append(equiMenu);
			}
		});
		/* 获取侧边栏普通用户设备列表【结束】 */
	</script>
	<script type="text/javascript">
		var userId = "";						//用户主键
		var menuId = "";					//菜单主键
		var equiId="";						//设备主键
		/*模态框操作【开始】*/
		var myModal = document.getElementById("portlet-config");
		var myAlertInfo = document.getElementById("alertInfo");
		var myConfirmInfo = document.getElementById("confirmInfo");
		//打开模态框
		function openModal(title, url, param){
			if(myModal.style.display == "none"){
				myModal.style.display = "block";
				myModal.style.width = (param.width == null)?("1200px"):(param.width+"px");
				myModal.style.height = (param.height == null)?("900px"):(param.height+"px");
			}
			equiId=param.equipmentId;
			userId=param.userId;
			$("#modal-title").html("");
			$("#modal-body").html("");
			$("#modal-title").html(title);
			$("#modal-body").load(url);
		}
		//关闭模态框
		function closeModal(){
			if(myModal.style.display == "block"){
				myModal.style.display = "none";
			}
		}
		//拖拽模态框【开始】
		/* var div = document.getElementById("portlet-config");
		var dragFlag = false;
		var x,y;
		div.onmousedown = function (e) {
		    e = e || window.event;
		    x = e.clientX - div.offsetLeft;
		    y = e.clientY - div.offsetTop;
		    dragFlag = true;
		};
		document.onmousemove = function (e) {
		    if (dragFlag) {
		        e = e || window.event;
		        div.style.left = (e.clientX - x) + "px";
		        div.style.top  = (e.clientY - y) + "px";
		    }
		};
		document.onmouseup = function (e) {
		    dragFlag = false;
		}; */
		//拖拽模态框【结束】
		/*模态框操作【结束】*/
		/*alertInfo操作【开始】*/
		function openAlertInfo(param){
			if(myConfirmInfo.style.display == "block"){
				myConfirmInfo.style.display = "none";
			}
			myAlertInfo.style.display = "block";
			$("#alert-info-body").text(param);
		}
		function closeAlert(){
			if(myAlertInfo.style.display == "block"){
				myAlertInfo.style.display = "none";
			}
		}
		/*alertInfo操作【结束】*/
		/*confirmInfo操作【结束】*/
		/* function openConfirmInfo(param){
			if(myAlertInfo.style.display == "block"){
				myAlertInfo.style.display = "none";
			}
			myConfirmInfo.style.display = "block";
			$("#confirm-info-body").text(param);
			return confirmResult();
		}
		function confirmResult(){
			alert($(this).attr("style"));
			myConfirmInfo.style.display = "none";
		} */
		/*confirmInfo操作【结束】*/
		//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【开始】
		function formatDateToString(param){
			var y = param.getFullYear();
			var M = unifiedFormat(param.getMonth()+1);
			var d = unifiedFormat(param.getDate());
			var H = unifiedFormat(param.getHours());
			var m = unifiedFormat(param.getMinutes());
			var s = unifiedFormat(param.getSeconds());
			var result = y+"-"+M+"-"+d+" "+H+":"+m+":"+s;
			return result;
		}
		function formatInitDateToString(param){
			var y = param.getFullYear();
			var M = unifiedFormat(param.getMonth()+1);
			var d = unifiedFormat(param.getDate());
			var result = y+"-"+M+"-"+d+" 00:00:00";
			return result;
		}
		//统一显示格式
		function unifiedFormat(param){
			return (param<10)?("0"+param):param;
		}
		//组装时间：将时间转化成“yyyy-MM-dd HH:mm:ss”格式的字符串【结束】
		
		<!-- 关联侧边栏和展示内容【开始】 -->
		function loadContext(param){
			//先清空页面原有内容
			$("#page-content").empty();
			//再引入新的界面
			if(param==101){
				$("#page-content").load("childrenHtml/user/user-list.html");
			}else if(param==201){
				$("#page-content").load("childrenHtml/equipment/equi-list.html");
			}else if(param==301){
				openAlertInfo("测试?");
				/* $("#page-content").load("childrenHtml/data/equi-data-list.html"); */
			}else{
				equiId=param;
				$("#page-content").load("childrenHtml/data/data-list.html");
			}
		}
		<!-- 关联侧边栏和展示内容【结束】 -->
	</script>

</body>
<!-- END BODY -->
</html>